<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8" />
		<title>WebStats: Visualization Promotes Information</title>	
		<style type="text/css">
			body
			{
				font-family: sans-serif, arial;
				margin: 0px;
				padding: 0px;
				overflow-x: hidden;
			}
			.logo-bar > img
			{
				border: solid 10px white;
				vertical-align: bottom;
				margin-left: 0.5em;
			}
			.logo-bar
			{
				position: relative;
				width: 100%;
				background: #4fc4ff;
				color: #FFF;
				font-size: 3em;
				padding: 1em;
			}
			canvas,h1 {
				display:block;
				margin:20px auto;
				max-width:60%;
				text-align:center;
			}
		</style>
		<script type="application/javascript" src="./js/jquery-1.7.2.min.js"></script>
		<script type="application/javascript" src="./js/webstats.js"></script>
	</head>
	<body>
		<script>
		var monthNames = ["January", "February", "March", "April", "May", "June",
		  "July", "August", "September", "October", "November", "December"
		];
		var districts = {};
		var types = {};
		$.getJSON('https://data.raleighnc.gov/resource/3bhm-we7a.json',function(data){
			for(var i in data)
			{
				if(data.hasOwnProperty(i))
					for(var j in data[i])
					{
						/* Districts */
						if(typeof(districts[data[i][j]]) === "undefined" && j === "district")
							districts[data[i][j]] = 1;
						else if(j === "district")
							districts[data[i][j]]++;

						/* Type of Incident */
						if(typeof(types[data[i][j]]) === "undefined" && j === "lcr_desc")
							types[data[i][j]] = 1;
						else if(j === "lcr_desc")
							types[data[i][j]]++;
					}
			}
			WebStats.BarGraph({
				title:'Police Incidents by District',
				chartCanvasID:'crime_areas',
				values:$.map(districts,function(v){return v;}),
				XLabels:Object.keys(districts),
				YLabels:Array(Object.keys(districts).length).join(' ').split(' ')
			});
			/*
			WebStats.PieChart({
				title:'Types of Police Incidents',
				chartCanvasID:'crime_types',
				values:$.map(types,function(v){return v;}),
				labels:Object.keys(types),
				width:1200,
				height:700
			}); */
			WebStats.start();
		});
		</script>
		<div class="logo-bar">
			WebStats<img src="images/logo.png" alt="Logo" />
		</div>

		<div id="chart">
			<h1>Raleigh Police Data From Socrata API</h1>
			<canvas id="crime_areas"></canvas>
		</div>
		<!--
		<div>
			<canvas id="crime_types"></canvas>
		</div> -->
	</body>
</html>
